[
  {
    "host": "ESGI5-server",
    "tasks": [
      {
        "task": "Administrator account",
        "msg": "enabled",
        "audit_status": "FAIL",
        "mitigation_advice": "Il est recommandé de désactiver le compte Administrateur par défaut et d'utiliser des comptes nominatifs avec droits maîtrisés (LAPS pour les mots de passe locaux).",
        "mitigation_cmd": "Disable-LocalUser -Name 'Administrator'"
      },
      {
        "task": "Guest account",
        "msg": "disabled",
        "audit_status": "PASS",
        "mitigation_advice": "Il est recommandé de désactiver le compte Guest par défaut si non utilisé.",
        "mitigation_cmd": "Disable-LocalUser -Name 'Guest'"
      },
      {
        "task": "Password policy minimum length",
        "msg": "FAIL (<12)",
        "audit_status": "FAIL",
        "mitigation_advice": "Augmentez la longueur minimale des mots de passe (recommandation: 12+ pour utilisateurs, 15+ pour comptes privilégiés).",
        "mitigation_cmd": "secedit /export /cfg C:\\temp\\secpol.cfg && (modifier LocalPolicies\\SecurityOptions ou GPO selon le contexte)"
      },
      {
        "task": "LAPS installation",
        "msg": "not installed",
        "audit_status": "FAIL",
        "mitigation_advice": "Installer et déployer Microsoft LAPS pour gérer automatiquement les mots de passe des comptes administrateurs locaux.",
        "mitigation_cmd": "Install-Module -Name LAPS -Force # ou déployer l'installateur MSI Microsoft LAPS"
      },
      {
        "task": "UAC (EnableLUA)",
        "msg": "enabled",
        "audit_status": "PASS",
        "mitigation_advice": "Activer l'UAC pour réduire la surface d'exécution avec privilèges élevés.",
        "mitigation_cmd": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name EnableLUA -Value 1"
      },
      {
        "task": "SMBv1",
        "msg": "disabled",
        "audit_status": "PASS",
        "mitigation_advice": "Désactiver SMBv1, obsolète et vulnérable.",
        "mitigation_cmd": "Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart"
      },
      {
        "task": "SMB signing",
        "msg": "not required",
        "audit_status": "FAIL",
        "mitigation_advice": "Forcer la signature SMB côté serveur pour se protéger contre le relay NTLM.",
        "mitigation_cmd": "Set-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters' -Name requiresecuritysignature -Value 1"
      },
      {
        "task": "RDP SecurityLayer",
        "msg": "TLS (2)",
        "audit_status": "PASS",
        "mitigation_advice": "Configurer SecurityLayer à 2 pour forcer TLS pour RDP.",
        "mitigation_cmd": "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -Name SecurityLayer -Value 2"
      },
      {
        "task": "RDP NLA",
        "msg": "enabled",
        "audit_status": "PASS",
        "mitigation_advice": "Activer NLA pour protéger le service RDP.",
        "mitigation_cmd": "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -Name UserAuthentication -Value 1"
      },
      {
        "task": "Record dangerous services",
        "msg": "All items completed"
      },
      {
        "task": "Record firewall profiles",
        "msg": "All items completed"
      },
      {
        "task": "LLMNR",
        "msg": "enabled",
        "audit_status": "FAIL",
        "mitigation_advice": "Désactiver LLMNR via GPO pour prévenir le spoofing.",
        "mitigation_cmd": "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient' -Name EnableMulticast -Value 0"
      },
      {
        "task": "Audit logon/logoff",
        "msg": "configured",
        "audit_status": "PASS",
        "mitigation_advice": "Configurer l'audit pour succès et échecs sur logon/logoff via GPO.",
        "mitigation_cmd": "auditpol /set /subcategory:\"Logon/Logoff\" /success:enable /failure:enable"
      },
      {
        "task": "Security log size",
        "msg": "<1GB",
        "audit_status": "WARNING",
        "mitigation_advice": "Augmenter la taille du journal de sécurité pour éviter la perte d'événements.",
        "mitigation_cmd": "Limit via GPO or use wevtutil sl Security /ms:1073741824"
      },
      {
        "task": "Sysmon service",
        "msg": "not installed",
        "audit_status": "INFO",
        "mitigation_advice": "Installer Sysmon pour une meilleure journalisation si nécessaire.",
        "mitigation_cmd": "Install-Sysmon -accepteula -i sysmon-config.xml"
      }
    ]
  }
]